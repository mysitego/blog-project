<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إدارة المستخدمين | لوحة التحكم</title>
    <meta name="description" content="إدارة المستخدمين في لوحة تحكم المدونة">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/admin.css">
    <link rel="stylesheet" href="../css/dashboard.css">
    <link rel="stylesheet" href="../css/admin-images.css">
    <link rel="stylesheet" href="../css/admin-responsive.css">
    <link rel="stylesheet" href="../css/users.css">
    
    <!-- Favicon -->
    <link rel="icon" href="../images/logo.png" type="image/jpeg">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="admin-dashboard">
    <!-- الشريط الجانبي -->
    <aside class="admin-sidebar" id="adminSidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">
                <img src="../images/logo.png" alt="شعار المدونة" class="sidebar-logo-img">
                <div class="sidebar-logo-text">
                    <h3>مدونة المعرفة</h3>
                    <span>لوحة التحكم</span>
                </div>
            </div>
            <button class="sidebar-toggle" id="sidebarToggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>

        <nav class="sidebar-nav">
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="dashboard.html" class="nav-link">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>لوحة التحكم</span>
                    </a>
                </li>
                
                <li class="nav-item">
                    <a href="posts.html" class="nav-link">
                        <i class="fas fa-edit"></i>
                        <span>المقالات</span>
                        <span class="nav-badge">25</span>
                    </a>
                </li>
                
                <li class="nav-item">
                    <a href="categories.html" class="nav-link">
                        <i class="fas fa-tags"></i>
                        <span>الفئات</span>
                    </a>
                </li>
                
                <li class="nav-item">
                    <a href="comments.html" class="nav-link">
                        <i class="fas fa-comments"></i>
                        <span>التعليقات</span>
                        <span class="nav-badge new">12</span>
                    </a>
                </li>
                
                <li class="nav-item active">
                    <a href="users.html" class="nav-link">
                        <i class="fas fa-users"></i>
                        <span>المستخدمون</span>
                    </a>
                </li>
                
                <li class="nav-item">
                    <a href="#" class="nav-link nav-dropdown-toggle">
                        <i class="fas fa-chart-line"></i>
                        <span>التقارير</span>
                        <i class="fas fa-chevron-down nav-arrow"></i>
                    </a>
                    <ul class="nav-dropdown">
                        <li><a href="analytics.html">الإحصائيات</a></li>
                        <li><a href="reports.html">التقارير</a></li>
                        <li><a href="performance.html">الأداء</a></li>
                    </ul>
                </li>
                
                <li class="nav-item">
                    <a href="media.html" class="nav-link">
                        <i class="fas fa-images"></i>
                        <span>الوسائط</span>
                    </a>
                </li>
                
                <li class="nav-item">
                    <a href="settings.html" class="nav-link">
                        <i class="fas fa-cog"></i>
                        <span>الإعدادات</span>
                    </a>
                </li>
            </ul>
        </nav>

        <div class="sidebar-footer">
            <div class="user-info">
                <img src="../images/avatar-1.png" alt="صورة المستخدم" class="user-avatar">
                <div class="user-details">
                    <span class="user-name">المدير العام</span>
                    <span class="user-role">مدير</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- المحتوى الرئيسي -->
    <main class="admin-main">
        <header class="admin-header">
            <div class="header-left">
                <button class="mobile-sidebar-toggle" id="mobileSidebarToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="page-title">
                    <h1>إدارة المستخدمين</h1>
                    <span class="page-subtitle">عرض وإدارة حسابات المستخدمين</span>
                </div>
            </div>

            <div class="header-actions">
                <a href="user-new.html" class="btn btn-primary">
                    <i class="fas fa-user-plus"></i>
                    إضافة مستخدم جديد
                </a>
            </div>
        </header>

        <div class="users-content">
            <div class="users-header">
                <a href="#" class="btn btn-primary" id="addUserBtn">
                    <i class="fas fa-plus"></i> إضافة مستخدم جديد
                </a>
                <div>
                    <input type="text" class="search-input" placeholder="بحث عن مستخدم...">
                    <button class="search-btn" title="بحث"><i class="fas fa-search"></i></button>
                </div>
            </div>
            <div class="users-table">
                <table>
                    <thead>
                        <tr>
                            <th>الاسم</th>
                            <th>البريد الإلكتروني</th>
                            <th>الدور</th>
                            <th>الحالة</th>
                            <th>الإجراءات</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>سارة علي</td>
                            <td>sara@example.com</td>
                            <td>مدير</td>
                            <td><span class="badge bg-success">نشط</span></td>
                            <td class="actions">
                                <button class="btn-action" data-action="edit" data-id="1" title="تعديل"><i class="fas fa-edit"></i></button>
                                <button class="btn-action" data-action="delete" data-id="1" title="حذف"><i class="fas fa-trash"></i></button>
                            </td>
                        </tr>
                        <!-- المزيد من الصفوف ... -->
                    </tbody>
                </table>
            </div>
        </div>
        <!-- نافذة منبثقة لإضافة مستخدم جديد -->
        <div class="modal-overlay" id="addUserModal">
          <div class="modal-box">
            <h2>إضافة مستخدم جديد</h2>
            <form id="userForm">
              <div class="form-group">
                <label for="userName">الاسم</label>
                <input type="text" id="userName" name="userName" class="form-control" required>
              </div>
              <div class="form-group">
                <label for="userEmail">البريد الإلكتروني</label>
                <input type="email" id="userEmail" name="userEmail" class="form-control" required>
              </div>
              <div class="form-group">
                <label for="userRole">الدور</label>
                <select id="userRole" name="userRole" class="form-control" required>
                  <option value="">اختر الدور</option>
                  <option value="admin">مدير</option>
                  <option value="editor">محرر</option>
                  <option value="author">كاتب</option>
                </select>
              </div>
              <div class="modal-actions">
                <button type="submit" class="btn btn-primary">حفظ</button>
                <button type="button" class="btn btn-secondary" id="closeUserModal">إلغاء</button>
              </div>
            </form>
          </div>
        </div>
    </main>

    <!-- JavaScript Files -->
    <script src="../js/main.js"></script>
    <script src="../js/admin-dashboard.js"></script>
    <script src="../js/users.js"></script>
    <script>
    $(document).ready(function() {
        // توليد كلمة مرور عشوائية
        function generatePassword(length = 12) {
            const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+~`|}{[]\\:;?><,./-=';
            let password = '';
            for (let i = 0; i < length; i++) {
                const randomIndex = Math.floor(Math.random() * charset.length);
                password += charset[randomIndex];
            }
            return password;
        }

        // توليد كلمة مرور
        $('#generatePassword').click(function() {
            const password = generatePassword();
            const passwordField = $('#userPassword');
            const fieldType = passwordField.attr('type');
            
            // تغيير نوع الحقل مؤقتاً لضمان عرض النص
            passwordField.attr('type', 'text').val(password);
            
            // إعادة تعيين نوع الحقل بعد ثانيتين
            setTimeout(() => {
                if (fieldType === 'password') {
                    passwordField.attr('type', 'password');
                }
            }, 2000);
        });

        // إظهار/إخفاء كلمة المرور
        $('#togglePassword').click(function() {
            const passwordField = $('#userPassword');
            const type = passwordField.attr('type') === 'password' ? 'text' : 'password';
            passwordField.attr('type', type);
            $(this).find('i').toggleClass('fa-eye fa-eye-slash');
        });

        // رفع صورة الملف الشخصي
        $('#uploadAvatarBtn, .avatar-preview').click(function() {
            $('#avatarUpload').click();
        });

        // معاينة الصورة المرفوعة
        $('#avatarUpload').change(function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    $('#avatarPreview').attr('src', event.target.result);
                };
                reader.readAsDataURL(file);
            }
        });

        // إزالة صورة الملف الشخصي
        $('#removeAvatarBtn').click(function() {
            $('#avatarPreview').attr('src', '../images/avatar-placeholder.png');
            $('#avatarUpload').val('');
        });

        // إرسال نموذج إضافة مستخدم
        $('#addUserForm').submit(function(e) {
            e.preventDefault();
            
            // جمع بيانات النموذج
            const userData = {
                name: $('#userName').val(),
                email: $('#userEmail').val(),
                role: $('#userRole').val(),
                password: $('#userPassword').val(),
                bio: $('#userBio').val(),
                avatar: $('#avatarPreview').attr('src')
            };
            
            // هنا يمكنك إضافة كود لإرسال البيانات إلى الخادم
            console.log('بيانات المستخدم:', userData);
            
            // عرض رسالة نجاح
            alert('تمت إضافة المستخدم بنجاح!');
            
            // إغلاق المودال
            const modal = bootstrap.Modal.getInstance(document.getElementById('addUserModal'));
            modal.hide();
            
            // إعادة تعيين النموذج
            this.reset();
            $('#avatarPreview').attr('src', '../images/avatar-placeholder.png');
            
            // إعادة تحميل قائمة المستخدمين أو إضافة المستخدم الجديد إلى الجدول
            // location.reload();
        });
    });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
